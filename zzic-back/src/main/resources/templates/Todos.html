<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>TO DO LIST</title>
	<style>
      :root {
          --pastel-pink: #FFD6E0;  /* 메인 색상을 따뜻한 핑크로 변경 */
          --pastel-lavender: #E8D5F9;  /* 보조 색상 */
          --pastel-mint: #C3E8E2;  /* 민트색 약간 더 부드럽게 */
          --pastel-peach: #FFE2D1;  /* 피치색 더 부드럽게 */
          --pastel-yellow: #FFF3D6;  /* 새로운 파스텔 옐로우 추가 */
					--pastel-green: #D1F2C9;  /* 새로운 파스텔 그린 추가 */
					--pastel-sky: #cdfaec;  /* 새로운 파스텔 하늘 추가 */
          --grid-color: #EAEAEA;  /* 그리드 라인 더 연하게 */
          --text-color: #7A7A7A;  /* 텍스트 색상 더 부드럽게 */
      }

      body {
          font-family: "Comic Sans MS", cursive;
          color: var(--text-color);
          max-width: 800px;
          margin: 0 auto;
          padding: 2rem;
          background-color: white;
          background-image:
                  linear-gradient(var(--grid-color) 1px, transparent 1px),
                  linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
          background-size: 20px 20px;
      }

      header {
          text-align: center;
          margin-bottom: 2rem;
          position: relative;
      }

      h1 {
          display: inline-block;
          background-color: var(--pastel-pink);  /* 제목 배경색 변경 */
          padding: 0.5rem 2rem;
          border-radius: 15px;
          font-size: 2rem;
          position: relative;
      }

      /* Decorative elements */
      .star {
          position: absolute;
          color: #FFD700;
          font-size: 1.2rem;
      }

      .star:nth-child(1) { top: -10px; right: 20px; }
      .star:nth-child(2) { top: 10px; left: 30px; }

      .heart {
          position: absolute;
          color: #FFB6C6;
          font-size: 1.2rem;
      }

      .heart:nth-child(1) { bottom: -20px; right: 40px; }
      .heart:nth-child(2) { bottom: -15px; left: 30px; }

      .todo-container {
          padding: 2rem;
      }

      form {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          margin-bottom: 2rem;
      }

      input[type="text"], textarea {
          padding: 1rem;
          border: 2px solid var(--pastel-pink);
          border-radius: 10px;
          font-size: 1rem;
          font-family: inherit;
      }

      button {
          background-color: var(--pastel-lavender);  /* 버튼 배경색 변경 */
          border: none;
          border-radius: 10px;
          padding: 0.8rem 1.5rem;
          font-size: 1rem;
          cursor: pointer;
          transition: all 0.3s ease;
          font-family: inherit;
          color: var(--text-color);
      }

      button:hover {
          transform: scale(1.05);
          background-color: var(--pastel-lavender);  /* 호버 색상 변경 */
      }

      ul {
          list-style: none;
          padding: 0;
      }

      li {
          margin: 1rem 0;
          padding: 1rem;
          border-radius: 10px;
          display: flex;
          align-items: center;
          gap: 1rem;
          transition: all 0.3s ease;
      }

      li:nth-child(6n+1) { background-color: var(--pastel-pink); }
      li:nth-child(6n+5) { background-color: var(--pastel-yellow); }
      li:nth-child(6n+6) { background-color: var(--pastel-green); }
      li:nth-child(6n+4) { background-color: var(--pastel-peach); }
      li:nth-child(6n+2) { background-color: var(--pastel-sky); }
      li:nth-child(6n+3) { background-color: var(--pastel-mint); }

      a {
          color: var(--text-color);
          text-decoration: none;
          font-weight: bold;
          flex-grow: 1;
      }

      [data-done="true"] {
          order: 1;
          opacity: 0.6;
      }

      #todoList {
          display: flex;
          flex-direction: column;
      }
	</style>

	<script>
		function toggleTodo(id) {
			fetch('/todos/toggle', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded'
				},
				body: new URLSearchParams({ id: id })
			})
				.then(response => {
					if (response.ok) {
						const item = document.querySelector(`li[data-id="${id}"]`);
						const isDone = item.getAttribute('data-done') === 'true';
						item.setAttribute('data-done', !isDone);

						// Reorder the list
						const list = document.getElementById('todoList');
						const items = Array.from(list.children);
						items.sort((a, b) => {
							const aDone = a.getAttribute('data-done') === 'true';
							const bDone = b.getAttribute('data-done') === 'true';
							return aDone - bDone;
						});

						items.forEach(item => list.appendChild(item));
					} else {
						alert('Error toggling todo');
					}
				});
		}
	</script>
</head>
<body>
<header>
	<span class="star">⭐</span>
	<span class="star">⭐</span>
	<h1>TO DO LIST</h1>
	<span class="heart">♥</span>
	<span class="heart">♥</span>
</header>

<div class="todo-container">
	<form method="POST" th:action="@{/todos}" enctype="application/x-www-form-urlencoded">
		<input type="text" name="title" placeholder="할 일을 입력하세요" required />
		<textarea name="description" placeholder="상세 설명을 입력하세요"></textarea>
		<button type="submit">추가하기</button>
	</form>

	<ul id="todoList">
		<li th:each="todo : ${todos}"
				th:key="${todo.id}"
				th:attr="data-done=${todo.done}, data-id=${todo.id}"
				th:style="${todo.done ? 'order: 1' : 'order: 0'}">
			<button type="button"
							th:text="${todo.done ? '미완료' : '완료'}"
							th:onclick="'toggleTodo(' + ${todo.id} + ')'"></button>
			<a th:href="@{/todos/{id}(id=${todo.id})}" th:text="${todo.title}"></a>
			<form method="POST" th:action="@{/todos/delete}" style="display: inline;">
				<input type="hidden" name="_method" value="DELETE" />
				<input type="hidden" name="id" th:value="${todo.id}" />
				<button type="submit">삭제</button>
			</form>
		</li>
	</ul>
</div>
</body>
</html>